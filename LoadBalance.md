# 로드밸런스

트래픽이 많아 지는 경우에는 다음과 같은 방법으로 해결 가능
- scale-up : 서버의 장비 업그레이드
- scale-out : 장비를 여러 개로 증가

scale-out의 경우, 트래픽을 서버에 할당시켜주는 것이 로드밸런스  
즉, 서버의 부하를 분산하는 작업

---

## 동작 방식 
클라이언트는 서버에 요청을 보내기 위해서  
클라이언트가 로드밸런스 주소를 통해 요청을 하고,  
로드밸런스가 서버에게 전달  

요청을 받은 서버는 응답을 로드밸런스에게 전달하고,  
로드밸런스가 다시 클라이언트에게 전달  

응답의 경우에는 로드밸런스를 거치지 않고 바로 클라이언트에게 전달하기도 한다(로드밸런스의 부하를 줄일 수 있는 장점이 있다) - Direct SErver Routing

--- 

## 특징
### NAT
외부에서 볼때는 로드밸런스 주소만 보이기 때문에 내부의 private 주소를 숨길 수 있다.

### Health Check
서버에 health check 콜을 보내 정상적으로 작동하는지 확인

---

## 종류
### L4
ip, port(tcp, udp), mac  


### L7
Application  
http, https(url, 확장자) 

---

## 알고리즘 종류

### Round Robin 라운드 로빈
균등하게 분산
서비의 성능이 동일하고 처리시간이 짧은 경우

### Weighted Round Robin 가중 라운드 로빈
서버에 가중치에 따라 분산  
가중치는 설정도 가능하고, 동적으로 조정되기도 한다  

### Least Connection 최소 연결
커넥션 수가 가장 적은 서버에 할당  
동적인 요청에 대해서 효율적으로 분산 가능

### Weighted Least Connections 가중 최소 연결
Least Connection 방식 + 서버 가중치  
서버의 스펙이 다양할 때 효과적

### Fastest Response Time 빠른 응답 시간
서버에 요청을 보내 응답 시간이 가장 빠른 서버로 요청  

### Source Hash 소스 해싱 
사용자의 IP를 해싱한 결과에 따라 분산  
사용자 IP는 고정이기 때문에 항상 같은 서버로 요청을 보냄


